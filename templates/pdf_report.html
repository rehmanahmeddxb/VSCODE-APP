<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: sans-serif; padding: 20px; color: #333; }
        h1 { text-align: center; color: #000; margin-bottom: 5px; }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .section-title { background: #f4f4f4; padding: 10px; font-weight: bold; margin-top: 20px; border-left: 5px solid #fbbf24; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
        th { background-color: #f8fafc; font-weight: bold; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }
        .summary-card { display: inline-block; width: 30%; border: 1px solid #ddd; padding: 10px; margin-right: 2%; vertical-align: top; }
        .text-success { color: #10b981; }
        .text-info { color: #0ea5e9; }
        .text-warning { color: #d97706; }
    </style>
</head>
<body>
    <div class="header">
        <h1>AHMED CEMENT INVENTORY ANALYSIS</h1>
        <p>Report Date: {{ date }}</p>
    </div>

    <div class="section-title">MATERIAL BRAND ANALYSIS</div>
    <table>
        <thead>
            <tr>
                <th>Material Brand</th>
                <th class="text-center">Total Received (IN)</th>
                <th class="text-center">Total Sent (OUT)</th>
                <th class="text-right">Remaining Balance</th>
            </tr>
        </thead>
        <tbody>
            {% for name, stats in analysis.items() %}
            <tr>
                <td style="font-weight: bold;">{{ name }}</td>
                <td class="text-center text-success">{{ stats.total|int }}</td>
                <td class="text-center text-info">{{ stats.sent|int }}</td>
                <td class="text-right text-warning" style="font-weight: bold; font-size: 14px;">{{ stats.remaining|int }} Bags</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="section-title">DETAILED TRANSACTION LOG</div>
    <table>
        <thead>
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Type</th>
                <th>Material</th>
                <th>Client</th>
                <th class="text-right">Qty</th>
                <th>Bill/Nimbus</th>
            </tr>
        </thead>
        <tbody>
            {% for e in entries %}
            <tr>
                <td>{{ e.date }}</td>
                <td>{{ e.time }}</td>
                <td style="font-weight: bold; color: {{ '#10b981' if e.type == 'IN' else '#0ea5e9' }}">{{ e.type }}</td>
                <td>{{ e.material }}</td>
                <td>{{ e.client or '---' }}</td>
                <td class="text-right">{{ e.qty|int }}</td>
                <td>{{ e.bill_no or '---' }} / {{ e.nimbus_no or '---' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div style="margin-top: 50px; text-align: right; font-size: 10px; color: #888;">
        Generated by Ahmed Cement Inventory System
    </div>
</body>
</html>
